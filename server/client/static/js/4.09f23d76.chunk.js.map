{"version":3,"sources":["components/home-page/sales-funnel/sales-funnel-modal.jsx","components/home-page/sales-funnel/helpers/loader.jsx","components/home-page/sales-funnel/helpers/tooltip-functions.js","components/home-page/sales-funnel/ClosestTask.jsx","components/home-page/sales-funnel/sales-funnel-students.jsx","components/home-page/sales-funnel/sales-funnel.jsx"],"names":["SalesFunnelModal","React","memo","funnel","Url","setPupilsList","status","setLoaded","bigIcon","update","defaultValueOptionFunnel","validateDiscordNickname","RegExp","dateFormat","useState","confirmLoading","setConfirmLoading","visible","setVisible","moment","dateValue","setDateValue","inputName","setInputName","inputSurname","setInputSurname","inputMidname","setInputMidname","selectGender","setSelectGender","inputParentPhones","setInputParentPhones","inputParentFullname","setInputParentFullname","inputChildPhones","setInputChildPhones","inputDiscordNickname","setInputDiscordNickname","_id","selectSalesFunnelStep","setSelectSalesFunnelStep","mask","setMask","mask2","setMask2","onFocusHandleInput","ev","target","value","onKeyDownInputHandler","event","key","prev","deletingDataFromForm","handleCancel","showModal","handleOk","a","swallErr","Error","split","filter","item","length","search","newStudent","name","surname","midname","gender","dateOfBirth","toISOString","phones","undefined","discord","String","match","shift","parentPhones","parentFullname","salesFunnelStep","axiosCreateNewStudent","student","swallGood","closestTask","console","log","response","RestrictionMessage","data","message","localStorage_change","token","localStorage","removeItem","window","location","replace","style","position","right","className","id","onClick","fontSize","color","UserAddOutlined","StylesForUserAddOutlined","width","title","onCancel","footer","loading","type","action","method","onChange","hooksHandler","required","placeholder","defaultValue","format","autoComplete","onKeyDown","onFocus","StylesForInputMaskPhoneParentOrChild","join","map","step","LoaderTag","styled","div","props","precentage","Loader","tooltipNeedsCheckerOfSingleString","string","dop","maxLength","dopTooltipText","placement","tooltipCheckerOfTrioString","stud","ClosestTask","deadline","responsible","text","SalesFunnelStudents","card","pupils","pupilsList","pageSize","loaded","index","draggableId","provided","background","draggableProps","dragHandleProps","ref","innerRef","to","minPaidSubscription","portable","contains","statuses","stat","overlay","SalesFunnel","UrlProd","salesFunnelList","setSalesFunnelList","useEffect","axiosGetFunnelSteps","salesFunnelSteps","flat","salesFunnelFromServer","onDragEndHandler","result","destination","array1","source","droppableId","array2","splice","deletingElement","Array","from","Set","oldStatuses","el","axiosUpdateStudent","jstctn","onDragEnd","display","order","minPaidSubscriptionsAmount","provide","droppableProps"],"mappings":"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","file":"static/js/4.09f23d76.chunk.js","sourcesContent":["// imports from plugins\nimport React, {useState} from \"react\"\nimport {Button, DatePicker, Input, Modal} from \"antd\"\nimport moment from \"moment\"\nimport InputMask from \"react-input-mask\"\nimport {UserAddOutlined} from \"@ant-design/icons\"\n\n// imports from files of project\nimport {\n  FlexFunnelElement,\n  StylesForInputMaskPhoneParentOrChild,\n  StylesForUserAddOutlined\n} from \"./helpers/sales-funnel-styled\"\nimport {axiosCreateNewStudent} from \"./helpers/axios-requests\"\nimport {swallErr, swallGood} from \"../../../alert/alert\"\nimport RestrictionMessage from \"../../restriction-message/restriction-message\"\nimport localStorage_change from \"../../../#localStorage_change\"\nimport hooksHandler from \"../../../helpers/hooksHandler\"\n\nexport const SalesFunnelModal = React.memo(({\n                                              funnel,\n                                              Url,\n                                              setPupilsList,\n                                              status,\n                                              setLoaded,\n                                              bigIcon = false,\n                                              update = () => {\n                                              },\n                                              defaultValueOptionFunnel = ''\n                                            }) => {\n\n  // data\n  const validateDiscordNickname = new RegExp(/\\w+#[0-9]{4}/)\n  const dateFormat = \"DD-MM-YYYY\"\n  // data\n\n  // useState\n  const [confirmLoading, setConfirmLoading] = useState(false)\n  const [visible, setVisible] = useState(false)\n\n  const [dateValue, setDateValue] = useState(moment(\"01-01-2021\", dateFormat))\n  const [inputName, setInputName] = useState(\"\")\n  const [inputSurname, setInputSurname] = useState(\"\")\n  const [inputMidname, setInputMidname] = useState(\"\")\n  const [selectGender, setSelectGender] = useState(\"\")\n  const [inputParentPhones, setInputParentPhones] = useState(\"\")\n  const [inputParentFullname, setInputParentFullname] = useState(\"\")\n  const [inputChildPhones, setInputChildPhones] = useState(\"\")\n  const [inputDiscordNickname, setInputDiscordNickname] = useState(\"\")\n  const [selectSalesFunnelStep, setSelectSalesFunnelStep] = useState(funnel[0]._id)\n\n  const [mask, setMask] = useState([\"+9 (999) 999-99-99\"])\n  const [mask2, setMask2] = useState([\"+9 (999) 999-99-99\"])\n  // useState\n\n  // Methods\n  const onFocusHandleInput = (ev) => ev.target.value = ''\n  const onKeyDownInputHandler = (setMask) => {\n    return (event) => {\n      if (!(event.key === \"Enter\")) return\n\n      setMask(prev => prev = [...prev, \", \", prev[0]])\n    }\n  }\n  const deletingDataFromForm = () => {\n    setInputName(prev => prev = \"\")\n    setInputSurname(prev => prev = \"\")\n    setInputMidname(prev => prev = \"\")\n    setDateValue(prev => prev = moment(\"01-01-2021\", dateFormat))\n    setSelectGender(prev => prev = \"\")\n    setInputParentFullname(prev => prev = \"\")\n    setInputDiscordNickname(prev => prev = \"\")\n    setMask(prev => prev = [\"+9 (999) 999-99-99\"])\n    setMask2(prev => prev = [\"+9 (999) 999-99-99\"])\n  }\n  const handleCancel = () => {\n    setVisible(false)\n    deletingDataFromForm()\n  }\n  const showModal = () => {\n    setVisible(true)\n  }\n  const handleOk = async () => {\n    try {\n      setConfirmLoading(true)\n      if (selectGender === \"\") {\n        swallErr(\"Ошибка!\", \"Не указан пол\")\n        throw new Error(\"Не указан пол\")\n      }\n      if (!(inputParentFullname.split(\" \").filter(item => item !== \"\").length === 3)) {\n        swallErr(\"Ошибка!\", \"ФИО Родителя введены неверно\")\n        throw new Error(\"ФИО Родителя введены неверно\")\n      }\n      if (inputDiscordNickname !== \"\" && inputDiscordNickname.search(validateDiscordNickname) === -1) {\n        swallErr(\"Ошибка!\", \"Ник в дискорде был введён не верно, проверьте наличие '#' и цифр после неё, а так же русских букв\")\n        throw new Error(\"Ник в дискорде был введён не верно, проверьте наличие '#' и цифр после неё, а так же русских букв\")\n      }\n      if (!selectSalesFunnelStep) {\n        swallErr(\"Ошибка!\", \"Этап в воронке не выбран\")\n        throw new Error(\"Этап в воронке не выбран\")\n      }\n      const newStudent = {\n        name: inputName,\n        surname: inputSurname,\n        midname: inputMidname,\n        gender: selectGender,\n        dateOfBirth: dateValue.toISOString(),\n        phones: inputChildPhones.split(\",\") || undefined,\n        discord: inputDiscordNickname !== \"\" ? String(inputDiscordNickname.match(validateDiscordNickname).shift()) : undefined,\n        parentPhones: inputParentPhones.split(\",\"),\n        parentFullname: inputParentFullname,\n        salesFunnelStep: selectSalesFunnelStep\n      }\n      const student = await axiosCreateNewStudent(Url, newStudent)\n      swallGood(\"Успешно!\", \"Пользователь создан!\")\n      update()\n      await setPupilsList(prev => [...prev, {...student, closestTask: []}])\n      setLoaded((prev => prev = true))\n      setLoaded((prev => prev = false))\n      setVisible(false)\n      setConfirmLoading(false)\n      deletingDataFromForm()\n    } catch (err) {\n      if (!status) console.log(err)\n      setVisible(true)\n      setConfirmLoading(false)\n      if (err.response) {\n        RestrictionMessage(err.response.status)\n        let {status, data} = err.response\n        if (status === 400) {\n          swallErr(\"Не верно введены данные\")\n        }\n        if (data.message === \"TOKEN_EXPIRED\") {\n          localStorage_change(data.token)\n        }\n        if (status === 401) {\n          localStorage.removeItem(\"tokenID\")\n          window.location.replace(\"/\")\n        }\n        if (status === 500) {\n          swallErr(\"Ошибка сервера\")\n        }\n      }\n    }\n  }\n  // Methods\n\n  return (\n    <>\n      {bigIcon ?\n        <div\n          style={{\n            position: 'absolute',\n            right: 0\n          }}\n          className=\"collapse d-flex flex-row-reverse\"\n          id=\"navbarScroll\">\n          <div className=\"d-flex plus-box\">\n            <div\n              className=\"nav-item plus\"\n              onClick={showModal}\n            >\n              <i\n                className=\"bi bi-person-plus\"\n                style={{\n                  fontSize: '38px',\n                  color: '#F56767'\n                }}\n              ></i>\n            </div>\n          </div>\n        </div> :\n        <UserAddOutlined style={StylesForUserAddOutlined} onClick={showModal}/>\n      }\n      <Modal width={900} title=\"Создание ученика\" visible={visible} onCancel={handleCancel} footer={[\n        <Button key=\"back\" onClick={handleCancel}>\n          Отмена\n        </Button>,\n        <Button\n          key=\"submit\"\n          onClick={handleOk}\n          loading={confirmLoading}\n          type=\"primary\"\n        >\n          Добавить\n        </Button>\n      ]}>\n        <form action=\"#\" method=\"POST\">\n          <FlexFunnelElement>\n            <p>Имя:</p>\n            <Input onChange={hooksHandler(setInputName, \"event.target.value\")} value={inputName} required/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Фамилия:</p>\n            <Input onChange={hooksHandler(setInputSurname, \"event.target.value\")} value={inputSurname} required/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Отчество:</p>\n            <Input onChange={hooksHandler(setInputMidname, \"event.target.value\")} value={inputMidname} required/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Возраст:</p>\n            <DatePicker className=\"form-control\" placeholder=\"ГГГГ.ММ.ДД\"\n                        defaultValue={moment(\"01-01-2021\", dateFormat)} format={dateFormat}\n                        onChange={hooksHandler(setDateValue, \"event\")}/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>ФИО Родителя:</p>\n            <Input onChange={hooksHandler(setInputParentFullname, \"event.target.value\")} value={inputParentFullname}\n                   required\n                   placeholder=\"Фамилия Имя Отчество\"/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Ник в дискорде:</p>\n            <Input onChange={hooksHandler(setInputDiscordNickname, \"event.target.value\")} value={inputDiscordNickname}\n                   placeholder=\"Необязательно\"/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Номер телефона ребёнка:</p>\n            <InputMask autoComplete=\"off\" onChange={hooksHandler(setInputChildPhones, \"event.target.value\")}\n                       onKeyDown={onKeyDownInputHandler(setMask)}\n                       onFocus={onFocusHandleInput}\n                       style={StylesForInputMaskPhoneParentOrChild} type=\"tel\" name=\"tel\"\n                       className=\"form-control\"\n                       mask={mask.join(\"\")} placeholder=\"Необязательное поле\"/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Номер телефона родителя:</p>\n            <InputMask autoComplete=\"off\" onChange={hooksHandler(setInputParentPhones, \"event.target.value\")}\n                       onKeyDown={onKeyDownInputHandler(setMask2)}\n                       onFocus={onFocusHandleInput}\n                       style={StylesForInputMaskPhoneParentOrChild} type=\"tel\" name=\"tel\"\n                       className=\"form-control\" mask={mask2.join(\"\")}/>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Пол:</p>\n            <select onChange={hooksHandler(setSelectGender, \"event.target.value\")} name=\"gender\" value={selectGender}\n                    className=\"form-control\"\n                    required>\n              <option defaultValue></option>\n              <option value=\"Мужской\">Мужской</option>\n              <option value=\"Женский\">Женский</option>\n            </select>\n          </FlexFunnelElement>\n          <FlexFunnelElement>\n            <p>Воронка:</p>\n            <select className=\"form-control\" name=\"salesFunnelId\" value={selectSalesFunnelStep}\n                    onChange={hooksHandler(setSelectSalesFunnelStep, \"event.target.value\")}>\n              {defaultValueOptionFunnel}\n              {funnel.map(step => {\n                if (funnel[0]._id === step._id) {\n                  return <option key={step._id} value={step._id} defaultValue>{step.name}</option>\n                }\n                return <option key={step._id} value={step._id}>{step.name}</option>\n              })}\n            </select>\n          </FlexFunnelElement>\n        </form>\n      </Modal>\n    </>\n  )\n})","import React from \"react\"\nimport styled from \"@emotion/styled\"\n\nconst LoaderTag = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ${props => props.precentage ? \"100%\" : \"100vh\"};\n  .lds-ring {\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    height: 80px;\n  }\n  .lds-ring div {\n    box-sizing: border-box;\n    display: block;\n    position: absolute;\n    width: 64px;\n    height: 64px;\n    margin: 8px;\n    border: 8px solid #001529;\n    border-radius: 50%;\n    animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n    border-color: #001529 transparent transparent transparent;\n  }\n  .lds-ring div:nth-of-type(1) {\n    animation-delay: -0.45s;\n  }\n  .lds-ring div:nth-of-type(2) {\n    animation-delay: -0.3s;\n  }\n  .lds-ring div:nth-of-type(3) {\n    animation-delay: -0.15s;\n  }\n  @keyframes lds-ring {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n\n`\n\nexport const Loader = ({ precentage }) => {\n  return (\n    <LoaderTag precentage={precentage}>\n      <div className=\"lds-ring\">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n      </div>\n    </LoaderTag>\n  );\n};","// imports from plugins\nimport {Tooltip} from \"antd\"\nimport React from \"react\"\n\n// imports from files of project\nimport {FunnelStepText} from \"./sales-funnel-styled\"\n\nexport const tooltipNeedsCheckerOfSingleString = (length, string, dop = '', maxLength = 24, width = \"\", dopTooltipText = \"\") => {\n  if (length + dop.length > maxLength) {\n    return (\n      <Tooltip placement=\"leftTop\" title={`${dopTooltipText}${dopTooltipText !== \"\" ? \" \" : \"\"}${string}`}>\n        <FunnelStepText width={width}>{dop} {string}</FunnelStepText>\n      </Tooltip>\n    )\n  }\n  return <FunnelStepText>{dop} {string}</FunnelStepText>\n}\n\nexport const tooltipCheckerOfTrioString = (length, stud, dop = '', maxLength = 24, width = \"\", dopTooltipText = \"\") => {\n  if (length + dop.length > maxLength) {\n    return (\n      <Tooltip placement=\"leftTop\" title={`${dopTooltipText}${dopTooltipText !== \"\" ? \" \" : \"\"}${stud.surname} ${stud.name} ${stud.midname}`}>\n        <FunnelStepText width={width}>{stud.surname} {stud.name} {stud.midname}</FunnelStepText>\n      </Tooltip>\n    )\n  }\n  return <FunnelStepText>{stud.surname} {stud.name} {stud.midname}</FunnelStepText>\n}","import moment from \"moment\"\nimport React from \"react\"\n\nimport {DropdownClosestTask} from \"./helpers/sales-funnel-styled\"\n\nexport const ClosestTask = ({closestTask}) => {\n  return (\n    <DropdownClosestTask>\n      <p className=\"name\">{closestTask?.name}</p>\n      <p>До: {moment(closestTask?.deadline).format(\"DD/MM/YYYY | HH:mm\")}</p>\n      <p>Ответственнен: {closestTask?.responsible[0]?.surname} {closestTask?.responsible[0]?.name} {closestTask?.responsible[0]?.midname}</p>\n      <div>\n        {closestTask?.text}\n      </div>\n    </DropdownClosestTask>\n  )\n}","// imports from plugins\nimport React, {useState} from \"react\"\nimport {Draggable} from \"react-beautiful-dnd\"\nimport {NavLink} from \"react-router-dom\"\nimport {Tag, Dropdown} from \"antd\"\n\n// imports from files of project\nimport {\n  FunnelStepStudent,\n  HoverTask,\n  StatusesBlock,\n  VisibilitySpan\n} from \"./helpers/sales-funnel-styled\"\nimport {Loader} from \"./helpers/loader\"\nimport {tooltipCheckerOfTrioString} from \"./helpers/tooltip-functions\"\nimport {ClosestTask} from \"./ClosestTask\"\n\nexport const SalesFunnelStudents = ({Url, card, pupils, pageSize}) => {\n\n  // data\n  const {pupilsList} = pupils\n  // data\n\n  // useState\n  const [loaded] = useState(false)\n  // useState\n\n  return (\n    <>\n      {loaded ? <Loader\n        precentage={true}/> : pupilsList.filter(stud => stud.salesFunnelStep === card._id).map((stud, index) => (\n        <Draggable key={stud._id} draggableId={`${stud._id}`} index={index}>\n          {provided => (\n            <FunnelStepStudent background={card.background} {...provided.draggableProps}\n                               {...provided.dragHandleProps} ref={provided.innerRef}>\n              <div className=\"funnelStepStudent__first--info\">\n                <div>\n                  <NavLink to={`/student/${stud._id}`}>\n                    {tooltipCheckerOfTrioString(`${stud.surname} ${stud.name} ${stud.midname}`.length, stud, \"\", 25, \"230px\", \"ФИО:\")}\n                  </NavLink>\n                </div>\n                <div>\n                  <VisibilitySpan>Тел.Родителя:</VisibilitySpan> {/*stud?.phones?.length > 1 ? `${stud?.phones[0]}...` : stud?.phones[0]*/}78\n                </div>\n                <div>\n                  <VisibilitySpan>Мин.Абонемент:</VisibilitySpan> {stud.minPaidSubscription || 0}₽\n                </div>\n                <StatusesBlock portable={true} contains={stud.statuses.length}>\n                  {stud.statuses.map(stat => (\n                    <Tag key={stat._id} color={stat.color}>{stat.name}</Tag>\n                  ))}\n                </StatusesBlock>\n                {stud.closestTask.length ? <Dropdown overlay={<ClosestTask closestTask={stud.closestTask[0]}/>}>\n                  <HoverTask>\n                    Ближайшая задача\n                  </HoverTask>\n                </Dropdown> : \"\"}\n              </div>\n            </FunnelStepStudent>\n          )}\n        </Draggable>\n      ))}\n    </>\n\n  )\n}","// imports from plugins\nimport React, {useEffect, useState} from \"react\"\nimport {DragDropContext, Droppable} from \"react-beautiful-dnd\"\n\n// imports from files of project\nimport {\n  FunnelSection,\n  FunnelStep,\n  FunnelStepAbonementSum,\n  FunnelStepHeader,\n  Wrapper\n} from \"./helpers/sales-funnel-styled\"\nimport {SalesFunnelModal} from \"./sales-funnel-modal\"\nimport {Loader} from \"./helpers/loader\"\nimport {tooltipNeedsCheckerOfSingleString} from \"./helpers/tooltip-functions\"\nimport UrlProd from \"../../../url/url\"\nimport {SalesFunnelStudents} from \"./sales-funnel-students\"\nimport {axiosGetFunnelSteps, axiosUpdateStudent} from \"./helpers/axios-requests\"\n\nconst SalesFunnel = () => {\n\n  //TODO: Переименовать поля phone и phoneParent на мн.ч\n  //TODO: Поля phones и phoneParents теперь массив.\n\n  // data\n  const status = 1\n  const Url = status ? UrlProd : \"https://dvmncrm.herokuapp.com\"\n  // data\n\n  // useState\n  const [loaded, setLoaded] = useState(true)\n  const [salesFunnelList, setSalesFunnelList] = useState([])\n  const [pupilsList, setPupilsList] = useState([])\n  console.log(pupilsList)\n  // useState\n\n  // useEffect\n  useEffect(() => {\n    const salesFunnelFromServer = async () => {\n      const salesFunnelSteps = await axiosGetFunnelSteps(Url)\n      setSalesFunnelList(prev => prev = salesFunnelSteps)\n      setPupilsList(prev => prev = salesFunnelSteps.map(step => step.pupils).flat(2))\n      setLoaded(prev => prev = false)\n    }\n    salesFunnelFromServer()\n    return () => {\n      setSalesFunnelList(prev => prev = [])\n      setPupilsList(prev => prev = [])\n    }\n  }, [Url])\n  // useEffect\n\n  // Methods\n  const onDragEndHandler = async (result) => {\n    if (!result.destination) {\n      return setPupilsList(prev => prev)\n    }\n\n    const array1 = pupilsList.filter((stud) => stud.salesFunnelStep === result.source.droppableId)\n    const array2 = pupilsList.filter((stud) => stud.salesFunnelStep === result.destination.droppableId)\n    const [deletingElement] = array1.splice(result.source.index, 1)\n\n    if (result.source.droppableId === result.destination.droppableId) {\n      array1.splice(result.destination.index, 0, deletingElement)\n\n      return setPupilsList(prev => Array.from(new Set([...prev, ...array1, ...array2])))\n    }\n\n    const oldStatuses = deletingElement.statuses\n    deletingElement.statuses = deletingElement.statuses.map(el => el = el._id)\n    deletingElement.salesFunnelStep = result.destination.droppableId\n\n    await axiosUpdateStudent(Url, deletingElement._id, deletingElement)\n    deletingElement.statuses = oldStatuses\n\n    array2.splice(result.destination.index, 0, deletingElement)\n\n    return setPupilsList(prev => Array.from(new Set([...prev, ...array1, ...array2])))\n  }\n  // Methods\n\n  return (\n    <Wrapper>\n      {loaded ? <Loader/> : <FunnelSection jstctn={salesFunnelList.length < 6 ? true : false}>\n        <DragDropContext onDragEnd={onDragEndHandler}>\n          {salesFunnelList.map(card =>\n            <FunnelStep key={card._id} style={card.name === \"Занимаются\" || card.name === \"Занимается\" ? {display: \"none\"} : {display: \"block\"}} className={\"card\"}>\n              <FunnelStepHeader background={card.background}>\n                {tooltipNeedsCheckerOfSingleString(card.name.length, card.name, \"\", 30, \"220px\")}\n                {card.order === 1 ? <SalesFunnelModal setLoaded={setLoaded} status={status}\n                                                      funnel={salesFunnelList} Url={Url}\n                                                      setPupilsList={setPupilsList}/> : \"\"}\n              </FunnelStepHeader>\n              <FunnelStepAbonementSum background={card.background}>\n                {card.minPaidSubscriptionsAmount || 0}руб.\n              </FunnelStepAbonementSum>\n              <Droppable droppableId={`${card._id}`}>\n                {provide => (\n                  <div className=\"droppable-container\" {...provide.droppableProps}\n                       ref={provide.innerRef}>\n                    <SalesFunnelStudents card={card} pupils={{pupilsList, setPupilsList}} Url={Url}/>\n                    {provide.placeholder}\n                  </div>\n                )}\n              </Droppable>\n            </FunnelStep>\n          )}\n        </DragDropContext>\n      </FunnelSection>}\n    </Wrapper>\n  )\n}\n\nexport default SalesFunnel"],"sourceRoot":""}