(this["webpackJsonpcrm-shool-app"]=this["webpackJsonpcrm-shool-app"]||[]).push([[5],{671:function(e,n,t){"use strict";t.r(n);var r,a,c,i,s,o,u,d,l,f,j,b,p=t(17),O=t.n(p),x=t(9),h=t(33),k=t(4),m=t(0),v=t.n(m),g=t(21),y=t.n(g),T=t(25),w=t(10),C=function(e){return"Expired"===e?"crimson":"Today"===e?"#6290FF":"Tomorrow"===e?"#7C9C51":void 0},S=w.a.div(r||(r=Object(T.a)(["\n  font-family: Tahoma, sans-serief;\n"]))),F=w.a.div(a||(a=Object(T.a)(["\n  display: flex;\n  color: black;\n  > div {\n    width: calc(100% / 3);\n  }\n"]))),R=w.a.div(c||(c=Object(T.a)(["\n  margin: 0 0 8px 0;\n  position: relative;\n  text-align: center;\n  padding: 5px 0;\n  font-size: 20px;\n  font-weight: 600;\n  border-bottom: 4px solid ",';\n  &::before {\n    position: absolute;\n    content: "";\n    display: inline-block;\n    bottom: -19px;\n    right: calc(50% - 8px);\n    border-right: 8px solid transparent;\n    border-left: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n    border-top: 8px solid ',";\n  }\n"])),(function(e){return C(e.type)}),(function(e){return C(e.type)})),A=w.a.div(i||(i=Object(T.a)(["\n  padding: 0 5px 0 5px;\n"]))),M=w.a.div(s||(s=Object(T.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-radius: 8px;\n  padding: 5px;\n  background: ",";\n  margin: 0 0 10px 0;\n  font-size: 20px;\n  p {margin: 0;}\n"])),(function(e){return(n=e.status)<60?"#DC143C":n<90&&n>=60?"#F6CD52":n>=90?"#7C9C51":void 0;var n})),Y=w.a.div(o||(o=Object(T.a)(["\n  display: flex;\n  justify-content: space-between;\n  > div:first-of-type {\n    flex: 0 0 90%;\n  }\n"]))),_=w.a.div(u||(u=Object(T.a)(["\n  display: flex;\n  > .ant-select {\n    flex: 0 1 300px;\n  }\n  > button {\n    margin: 0 10px;\n  }\n"]))),D=w.a.div(d||(d=Object(T.a)(["\n  background: white;\n  margin: 10px 0;\n  padding: 5px;\n  border-radius: 2px;\n  border: 1px solid ",";\n  border-top: 4px solid ",";\n  > p {\n    margin: 0;\n    word-break: break-word;\n  }\n"])),(function(e){return C(e.type)}),(function(e){return C(e.type)})),E=w.a.div(l||(l=Object(T.a)(["\n  display: flex;\n  align-items: center;\n  font-weight: 600;\n"]))),I=w.a.p(f||(f=Object(T.a)(["\n  opacity: 0.8;\n"]))),B=w.a.p(j||(j=Object(T.a)(["\n  word-break: break-word;\n"]))),z=w.a.span(b||(b=Object(T.a)(["\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 22px;\n  min-height: 22px;\n  max-width: 22px;\n  max-height: 22px;\n  background: transparent;\n  border: 1px solid ",";\n  border-radius: 50%;\n  margin: 0 5px 0 0;\n  > span {\n    display: inline-block;\n    min-width: 16px;\n    min-height: 16px;\n    transition: all .2s ease;\n    background: ",";\n    border-radius: 50%;\n    &:hover {\n      opacity: 0.8;\n    }\n  }\n"])),(function(e){return C(e.type)}),(function(e){return e.active?C(e.type):"transparent"})),H=t(1),L=function(e){var n=e.active,t=e.onClick,r=e.type;return Object(H.jsx)(z,{onClick:t,active:n,type:r,children:Object(H.jsx)("span",{})})},J=t(281),P=t(13),K=t(280),N=t(384),U=t(34),q=function(e){var n=e.task,t=e.type,r=e.setCompletedTasks,a=e.setTasks,c=e.setReservTasks,i=Object(m.useState)(!1),s=Object(k.a)(i,2),o=s[0],u=s[1],d=function(){var e=Object(h.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u((function(e){return!e})),e.next=3,Object(J.a)(P.a,n._id,{done:!0});case 3:n.done=!0,r((function(e){return[].concat(Object(x.a)(e),[n]).filter((function(e){return e.done}))})),"Today"!==t&&c((function(e){return[].concat(Object(x.a)(e),[n])})),a((function(e){return e.filter((function(e){return!e.done}))}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(D,{type:o?"Tomorrow":t,children:[Object(H.jsxs)(E,{children:[Object(H.jsx)(L,{active:o,onClick:d,type:o?"Tomorrow":t}),n.for?Object(H.jsx)(U.c,{to:"/student/".concat((null===n||void 0===n?void 0:n.for)||""),children:n.name}):n.name,Object(H.jsx)(K.j,{portable:!1,contains:n.tags.length,children:n.tags.map((function(e){return Object(H.jsx)(N.a,{color:e.color,children:e.name},e._id)}))})]}),Object(H.jsxs)(I,{children:["\u0414\u043e: ",y()(null===n||void 0===n?void 0:n.deadline).format("DD/MM/YYYY | HH:mm")]}),Object(H.jsx)("p",{children:null===n||void 0===n?void 0:n.text})]})},G=function(e){var n=e.tasks,t=e.type,r=e.children,a=e.setReservTasks,c=e.setCompletedTasks,i=e.setTasks,s=void 0===i?function(){}:i;return Object(H.jsxs)("div",{children:[Object(H.jsx)(R,{type:t,children:r}),Object(H.jsx)(A,{children:n.map((function(e){return Object(H.jsx)(q,{task:e,type:t,setCompletedTasks:c,setTasks:s,setReservTasks:a},e._id)}))})]})},Q=t(116),V=t(367),W=function(e){var n=e.filterObj,t=Q.a.Option,r=n.setFilter,a=Object(m.useState)([]),c=Object(k.a)(a,2),i=c[0],s=c[1];Object(m.useEffect)((function(){(function(){var e=Object(h.a)(O.a.mark((function e(){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(V.a)(P.a);case 2:n=e.sent,s((function(e){return n}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return Object(H.jsx)(Q.a,{mode:"multiple",onChange:function(e){r((function(n){return e}))},children:i.map((function(e){return Object(H.jsx)(t,{value:e._id,children:e.name},e._id)}))})},X=t(62),Z=t(649),$=t(368),ee=function(e){e.url;var n=e.setAllTasks,t=e.filterTasks,r=Object(m.useState)(!1),a=Object(k.a)(r,2),c=a[0],i=a[1],s=function(){i((function(e){return!1}))};return Object(H.jsxs)(v.a.Fragment,{children:[Object(H.jsx)(X.a,{type:"primary",onClick:function(){i((function(e){return!e}))},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"}),Object(H.jsx)(Z.a,{width:800,className:"nonePaddingModal",visible:c,onOk:s,onCancel:s,footer:"",children:Object(H.jsx)($.a,{setOpenedModal:i,setRelTasks:n,portable:!1,filterTasks:t})})]})},ne=t(24),te=t.n(ne),re=function(){var e=Object(h.a)(O.a.mark((function e(n){var t,r,a=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:"",e.next=3,te.a.get("".concat(n,"/CRM/Tasks/CurrentUserTasks").concat(t),{headers:{authorization:"Bearer ".concat(localStorage.getItem("tokenID"))}}).then((function(e){return r=e.data}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ae=function(e){var n=e.reservTasks,t=e.completedTasks,r=e.statusTasks;return Object(H.jsxs)(M,{status:r,children:[Object(H.jsx)("div",{}),Object(H.jsxs)("p",{children:[t.length,"/",n.length]})]})},ce=t(645),ie=ce.a.TabPane,se=function(e){var n=e.viewbagFunnel,t=e.viewbagTable;return Object(H.jsxs)(ce.a,{defaultActiveKey:"1",children:[Object(H.jsx)(ie,{tab:"\u0412\u043e\u0440\u043e\u043d\u043a\u0430",children:n},"1"),Object(H.jsx)(ie,{tab:"\u0422\u0430\u0431\u043b\u0438\u0446\u0430",children:t},"2")]})},oe=t(2),ue=t(643),de=t(388),le=function(e){var n=e.tasks,t=(e.children,e.setReservTasks),r=e.setCompletedTasks,a=e.setTodayTasks,c=e.setExpiredTasks,i=e.setTomorrowTasks,s=function(){var e=Object(h.a)(O.a.mark((function e(n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(J.a)(P.a,n._id,{done:!0});case 2:n.done=!0,r((function(e){return e=[].concat(Object(x.a)(e),[n]).filter((function(e){return e.done}))})),y()(n.deadline).isBefore(y()().endOf("day"))&&y()(n.deadline).isAfter(y()().get())||t((function(e){return[].concat(Object(x.a)(e),[n])})),c((function(e){return e.filter((function(e){return!e.done}))})),a((function(e){return e.filter((function(e){return!e.done}))})),i((function(e){return e.filter((function(e){return!e.done}))}));case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o=n.filter((function(e){return!0!==e.done})).map((function(e){return Object(oe.a)(Object(oe.a)({},e),{},{complete:e,forLink:{for:e.for,name:e.name},key:e._id,deadline:y()(e.deadline).format("DD/MM/YYYY | HH:mm")})})),u=[{title:"",dataIndex:"complete",key:"complete",render:function(e){return Object(H.jsx)(de.a,{style:{fontSize:"20px",color:"crimson"},onClick:function(){return s(e)}})}},{title:"\u041a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u0441\u0440\u043e\u043a",dataIndex:"deadline",key:"deadline"},{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"forLink",key:"forLink",render:function(e){return e.for?Object(H.jsx)(U.c,{to:"/student/".concat((null===e||void 0===e?void 0:e.for)||""),children:e.name}):Object(H.jsx)("span",{children:e.name})}},{title:"\u0422\u0435\u043a\u0441\u0442",dataIndex:"text",key:"text",render:function(e){return Object(H.jsx)(B,{children:e})}},{title:"\u0422\u044d\u0433\u0438",dataIndex:"tags",key:"tags",render:function(e){return Object(H.jsx)(K.j,{portable:!0,contains:e.length,children:e.map((function(e){return Object(H.jsx)(N.a,{color:e.color,children:e.name},e._id)}))})}}];return Object(H.jsx)("div",{children:Object(H.jsx)(ue.a,{columns:u,dataSource:o})})};n.default=function(){var e=Object(m.useState)([]),n=Object(k.a)(e,2),t=n[0],r=n[1],a=Object(m.useState)([]),c=Object(k.a)(a,2),i=c[0],s=c[1],o=Object(m.useState)([]),u=Object(k.a)(o,2),d=u[0],l=u[1],f=Object(m.useState)([]),j=Object(k.a)(f,2),b=j[0],p=j[1],g=Object(m.useState)([]),T=Object(k.a)(g,2),w=T[0],C=T[1],R=Object(m.useState)([]),A=Object(k.a)(R,2),M=A[0],D=A[1],E=Object(m.useState)([]),I=Object(k.a)(E,2),B=I[0],z=I[1],L=Object(m.useState)(0),J=Object(k.a)(L,2),K=J[0],N=J[1];Object(m.useEffect)((function(){var e=function(e){return e.length?1===e.length?"?tag=".concat(e[0]):"?tag=".concat(e[0]).concat(e.filter((function(n){return n!==e[0]})).map((function(e){return"&tag=".concat(e)})).join("")):""}(t);return function(){var n=Object(h.a)(O.a.mark((function n(){var t,r,a,c;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,re(P.a,e);case 2:t=n.sent,r=t.filter((function(e){return y()(e.deadline).isBefore(y()().get())})),a=t.filter((function(e){return y()(e.deadline).isBefore(y()().endOf("day"))&&y()(e.deadline).isAfter(y()().get())})),c=t.filter((function(e){return y()(e.deadline).isAfter(y()().endOf("day"))})),C((function(e){return[].concat(Object(x.a)(a.filter((function(e){return e.done}))),Object(x.a)(c.filter((function(e){return e.done}))))})),D((function(e){return[].concat(Object(x.a)(a),Object(x.a)(c.filter((function(e){return e.done}))))})),l((function(e){return r.filter((function(e){return!e.done}))})),p((function(e){return a.filter((function(e){return!e.done}))})),z((function(e){return c.filter((function(e){return!e.done}))})),s((function(e){return t}));case 12:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()(),function(){l((function(e){return[]})),p((function(e){return[]})),z((function(e){return[]})),s((function(e){return[]})),C((function(e){return[]}))}}),[t]),Object(m.useEffect)((function(){N((function(e){return M.length?Math.round(w.length/M.length*100):100}))}),[w,M]);var U=Object(H.jsxs)(F,{children:[Object(H.jsx)(G,{tasks:d,type:"Expired",setCompletedTasks:C,setTasks:l,setReservTasks:D,children:"\u041f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438"}),Object(H.jsx)(G,{tasks:b,type:"Today",setCompletedTasks:C,setTasks:p,children:"\u0417\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(H.jsx)(G,{tasks:B,type:"Tomorrow",setCompletedTasks:C,setTasks:z,setReservTasks:D,children:"\u0417\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0437\u0430\u0432\u0442\u0440\u0430"})]}),q=Object(H.jsx)(v.a.Fragment,{children:Object(H.jsx)(le,{tasks:i,setReservTasks:D,setCompletedTasks:C,setTodayTasks:p,setExpiredTasks:l,setTomorrowTasks:z,children:"\u0417\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f"})});return Object(H.jsxs)(S,{children:[Object(H.jsx)(Y,{children:Object(H.jsx)(ae,{reservTasks:M,completedTasks:w,statusTasks:K})}),Object(H.jsxs)(_,{children:[Object(H.jsx)(W,{filterObj:{filter:t,setFilter:r}}),Object(H.jsx)(ee,{url:P.a,filterTasks:function(e){var n=e.filter((function(e){return y()(e.deadline).isBefore(y()().get())})),t=e.filter((function(e){return y()(e.deadline).isBefore(y()().endOf("day"))&&y()(e.deadline).isAfter(y()().get())})),r=e.filter((function(e){return y()(e.deadline).isAfter(y()().endOf("day"))}));return D((function(e){return[].concat(Object(x.a)(t),Object(x.a)(n.filter((function(e){return e.done}))),Object(x.a)(r.filter((function(e){return e.done}))))})),l((function(e){return n.filter((function(e){return!e.done}))})),p((function(e){return t.filter((function(e){return!e.done}))})),z((function(e){return r.filter((function(e){return!e.done}))})),e},setAllTasks:s})]}),Object(H.jsx)(se,{viewbagFunnel:U,viewbagTable:q})]})}}}]);
//# sourceMappingURL=5.518dcc85.chunk.js.map