(this["webpackJsonpcrm-shool-app"]=this["webpackJsonpcrm-shool-app"]||[]).push([[4],{671:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(9),a=n(18),i=n.n(a),s=n(35),l=n(4),o=n(0),j=n.n(o),u=n(669),d=n(280),b=n(648),O=n(62),p=n(650),h=n(279),x=n(20),f=n.n(x),v=n(175),m=n.n(v),g=n(672),k=n(172),S=n(23),y=n(128),w=n(1),_=function(e){e.target.value=""},C=function(e){return function(t){"Enter"===t.key&&e((function(e){return[].concat(Object(r.a)(e),[", ",e[0]])}))}};function N(e){var t=e.funnel,n=e.Url,a=e.setPupilsList,j=e.setLoaded,u=e.bigIcon,x=void 0!==u&&u,v=e.update,N=void 0===v?function(){}:v,F=e.defaultValueOptionFunnel,I=void 0===F?"":F,P=/\w+#\d{4}/,E="DD-MM-YYYY",T=Object(o.useState)(!1),Y=Object(l.a)(T,2),D=Y[0],L=Y[1],q=Object(o.useState)(!1),z=Object(l.a)(q,2),M=z[0],U=z[1],V=Object(o.useState)(f()("01-01-2021",E)),H=Object(l.a)(V,2),J=H[0],K=H[1],R=Object(o.useState)(""),A=Object(l.a)(R,2),B=A[0],G=A[1],Q=Object(o.useState)(""),W=Object(l.a)(Q,2),X=W[0],Z=W[1],$=Object(o.useState)(""),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(o.useState)(""),re=Object(l.a)(ce,2),ae=re[0],ie=re[1],se=Object(o.useState)(""),le=Object(l.a)(se,2),oe=le[0],je=le[1],ue=Object(o.useState)(""),de=Object(l.a)(ue,2),be=de[0],Oe=de[1],pe=Object(o.useState)(""),he=Object(l.a)(pe,2),xe=he[0],fe=he[1],ve=Object(o.useState)(""),me=Object(l.a)(ve,2),ge=me[0],ke=me[1],Se=Object(o.useState)(t[0]._id),ye=Object(l.a)(Se,2),we=ye[0],_e=ye[1],Ce=Object(o.useState)(["+9 (999) 999-99-99"]),Ne=Object(l.a)(Ce,2),Fe=Ne[0],Ie=Ne[1],Pe=Object(o.useState)(["+9 (999) 999-99-99"]),Ee=Object(l.a)(Pe,2),Te=Ee[0],Ye=Ee[1],De=function(){G((function(){return""})),Z((function(){return""})),ne((function(){return""})),K((function(){return f()("01-01-2021",E)})),ie((function(){return""})),Oe((function(){return""})),ke((function(){return""})),Ie((function(){return["+9 (999) 999-99-99"]})),Ye((function(){return["+9 (999) 999-99-99"]}))},Le=function(){U(!1),De()},qe=function(){U(!0)},ze=function(){var e=Object(s.a)(i.a.mark((function e(){var t,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,L(!0),""!==ae){e.next=5;break}throw Object(S.e)("\u041e\u0448\u0438\u0431\u043a\u0430!","\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u043f\u043e\u043b"),new Error("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u043f\u043e\u043b");case 5:if(3===be.split(" ").filter((function(e){return""!==e})).length){e.next=8;break}throw swallError("\u041e\u0448\u0438\u0431\u043a\u0430!","\u0424\u0418\u041e \u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e"),new Error("\u0424\u0418\u041e \u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e");case 8:if(""===ge||-1!==ge.search(P)){e.next=11;break}throw Object(S.e)("\u041e\u0448\u0438\u0431\u043a\u0430!","\u041d\u0438\u043a \u0432 \u0434\u0438\u0441\u043a\u043e\u0440\u0434\u0435 \u0431\u044b\u043b \u0432\u0432\u0435\u0434\u0451\u043d \u043d\u0435 \u0432\u0435\u0440\u043d\u043e, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 '#' \u0438 \u0446\u0438\u0444\u0440 \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u0451, \u0430 \u0442\u0430\u043a \u0436\u0435 \u0440\u0443\u0441\u0441\u043a\u0438\u0445 \u0431\u0443\u043a\u0432"),new Error("\u041d\u0438\u043a \u0432 \u0434\u0438\u0441\u043a\u043e\u0440\u0434\u0435 \u0431\u044b\u043b \u0432\u0432\u0435\u0434\u0451\u043d \u043d\u0435 \u0432\u0435\u0440\u043d\u043e, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 '#' \u0438 \u0446\u0438\u0444\u0440 \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u0451, \u0430 \u0442\u0430\u043a \u0436\u0435 \u0440\u0443\u0441\u0441\u043a\u0438\u0445 \u0431\u0443\u043a\u0432");case 11:if(we){e.next=14;break}throw Object(S.e)("\u041e\u0448\u0438\u0431\u043a\u0430!","\u042d\u0442\u0430\u043f \u0432 \u0432\u043e\u0440\u043e\u043d\u043a\u0435 \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d"),new Error("\u042d\u0442\u0430\u043f \u0432 \u0432\u043e\u0440\u043e\u043d\u043a\u0435 \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d");case 14:return t={name:B,surname:X,midname:te,gender:ae,dateOfBirth:J.toISOString(),phones:xe.split(",")||void 0,discord:""!==ge?String(ge.match(P).shift()):void 0,parentPhones:oe.split(","),parentFullname:be,salesFunnelStep:we},e.next=17,Object(k.a)(n,t);case 17:return s=e.sent,Object(S.f)("\u0423\u0441\u043f\u0435\u0448\u043d\u043e!","\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441\u043e\u0437\u0434\u0430\u043d!"),N(),e.next=22,a((function(e){return[].concat(Object(r.a)(e),[Object(c.a)(Object(c.a)({},s),{},{closestTask:[]})])}));case 22:j((function(){return!0})),j((function(){return!1})),U(!1),L(!1),De(),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),Object(S.e)("\u041e\u0448\u0438\u0431\u043a\u0430!","\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430");case 32:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[x?Object(w.jsx)("div",{style:{position:"absolute",right:0},className:"collapse d-flex flex-row-reverse",id:"navbarScroll",children:Object(w.jsx)("div",{className:"d-flex plus-box",children:Object(w.jsx)("div",{role:"button",tabIndex:"0",className:"nav-item plus",onClick:qe,children:Object(w.jsx)("i",{className:"bi bi-person-plus",style:{fontSize:"38px",color:"#F56767"}})})})}):Object(w.jsx)(g.a,{style:d.l,onClick:qe}),Object(w.jsx)(b.a,{width:900,title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0443\u0447\u0435\u043d\u0438\u043a\u0430",visible:M,onCancel:Le,footer:[Object(w.jsx)(O.a,{onClick:Le,children:"\u041e\u0442\u043c\u0435\u043d\u0430"},"back"),Object(w.jsx)(O.a,{onClick:ze,loading:D,type:"primary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"},"submit")],children:Object(w.jsxs)("form",{action:"#",method:"POST",children:[Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u0418\u043c\u044f:"}),Object(w.jsx)(p.a,{onChange:Object(y.a)(G,"event.target.value"),value:B,required:!0})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f:"}),Object(w.jsx)(p.a,{onChange:Object(y.a)(Z,"event.target.value"),value:X,required:!0})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e:"}),Object(w.jsx)(p.a,{onChange:Object(y.a)(ne,"event.target.value"),value:te,required:!0})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u0412\u043e\u0437\u0440\u0430\u0441\u0442:"}),Object(w.jsx)(h.a,{className:"form-control",placeholder:"\u0413\u0413\u0413\u0413.\u041c\u041c.\u0414\u0414",defaultValue:f()("01-01-2021",E),format:E,onChange:Object(y.a)(K,"event")})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u0424\u0418\u041e \u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044f:"}),Object(w.jsx)(p.a,{onChange:Object(y.a)(Oe,"event.target.value"),value:be,required:!0,placeholder:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f \u0418\u043c\u044f \u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u041d\u0438\u043a \u0432 \u0434\u0438\u0441\u043a\u043e\u0440\u0434\u0435:"}),Object(w.jsx)(p.a,{onChange:Object(y.a)(ke,"event.target.value"),value:ge,placeholder:"\u041d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e"})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0440\u0435\u0431\u0451\u043d\u043a\u0430:"}),Object(w.jsx)(m.a,{autoComplete:"off",onChange:Object(y.a)(fe,"event.target.value"),onKeyDown:C(Ie),onFocus:_,style:d.k,type:"tel",name:"tel",className:"form-control",mask:Fe.join(""),placeholder:"\u041d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f:"}),Object(w.jsx)(m.a,{autoComplete:"off",onChange:Object(y.a)(je,"event.target.value"),onKeyDown:C(Ye),onFocus:_,style:d.k,type:"tel",name:"tel",className:"form-control",mask:Te.join("")})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u041f\u043e\u043b:"}),Object(w.jsxs)("select",{onChange:Object(y.a)(ie,"event.target.value"),name:"gender",value:ae,className:"form-control",required:!0,children:[Object(w.jsx)("option",{value:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e",defaultValue:!0,children:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e"}),Object(w.jsx)("option",{value:"\u041c\u0443\u0436\u0441\u043a\u043e\u0439",children:"\u041c\u0443\u0436\u0441\u043a\u043e\u0439"}),Object(w.jsx)("option",{value:"\u0416\u0435\u043d\u0441\u043a\u0438\u0439",children:"\u0416\u0435\u043d\u0441\u043a\u0438\u0439"})]})]}),Object(w.jsxs)(d.b,{children:[Object(w.jsx)("p",{children:"\u0412\u043e\u0440\u043e\u043d\u043a\u0430:"}),Object(w.jsxs)("select",{className:"form-control",name:"salesFunnelId",value:we,onChange:Object(y.a)(_e,"event.target.value"),children:[I,t.map((function(e){return t[0]._id===e._id?Object(w.jsx)("option",{value:e._id,defaultValue:!0,children:e.name},e._id):Object(w.jsx)("option",{value:e._id,children:e.name},e._id)}))]})]})]})})]})}var F,I=j.a.memo(N),P=n(24),E=n(10).a.div(F||(F=Object(P.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ",";\n  .lds-ring {\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    height: 80px;\n  }\n  .lds-ring div {\n    box-sizing: border-box;\n    display: block;\n    position: absolute;\n    width: 64px;\n    height: 64px;\n    margin: 8px;\n    border: 8px solid #001529;\n    border-radius: 50%;\n    animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n    border-color: #001529 transparent transparent transparent;\n  }\n  .lds-ring div:nth-of-type(1) {\n    animation-delay: -0.45s;\n  }\n  .lds-ring div:nth-of-type(2) {\n    animation-delay: -0.3s;\n  }\n  .lds-ring div:nth-of-type(3) {\n    animation-delay: -0.15s;\n  }\n  @keyframes lds-ring {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n\n"])),(function(e){return e.precentage?"100%":"100vh"})),T=function(e){var t=e.precentage;return Object(w.jsx)(E,{precentage:t,children:Object(w.jsxs)("div",{className:"lds-ring",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{})]})})},Y=n(80),D=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:24,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return e+n.length>c?Object(w.jsx)(Y.a,{placement:"leftTop",title:"".concat(a).concat(""!==a?" ":"").concat(t),children:Object(w.jsxs)(d.h,{width:r,children:[n," ",t]})}):Object(w.jsxs)(d.h,{children:[n," ",t]})},L=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:24,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return e+n.length>c?Object(w.jsx)(Y.a,{placement:"leftTop",title:"".concat(a).concat(""!==a?" ":"").concat(t.surname," ").concat(t.name," ").concat(t.midname),children:Object(w.jsxs)(d.h,{width:r,children:[t.surname," ",t.name," ",t.midname]})}):Object(w.jsxs)(d.h,{children:[t.surname," ",t.name," ",t.midname]})},q=n(13),z=n(33),M=n(383),U=n(224),V=function(e){var t,n,c,r=e.closestTask;return Object(w.jsxs)(d.a,{children:[Object(w.jsx)("p",{className:"name",children:null===r||void 0===r?void 0:r.name}),Object(w.jsxs)("p",{children:["\u0414\u043e: ",f()(null===r||void 0===r?void 0:r.deadline).format("DD/MM/YYYY | HH:mm")]}),Object(w.jsxs)("p",{children:["\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u0435\u043d: ",null===r||void 0===r||null===(t=r.responsible[0])||void 0===t?void 0:t.surname," ",null===r||void 0===r||null===(n=r.responsible[0])||void 0===n?void 0:n.name," ",null===r||void 0===r||null===(c=r.responsible[0])||void 0===c?void 0:c.midname]}),Object(w.jsx)("div",{children:null===r||void 0===r?void 0:r.text})]})},H=function(e){e.Url;var t=e.card,n=e.pupils,r=(e.pageSize,n.pupilsList),a=Object(o.useState)(!1),i=Object(l.a)(a,1)[0];return Object(w.jsx)(w.Fragment,{children:i?Object(w.jsx)(T,{precentage:!0}):r.filter((function(e){return e.salesFunnelStep===t._id})).map((function(e,n){return Object(w.jsx)(u.b,{draggableId:"".concat(e._id),index:n,children:function(n){return Object(w.jsx)(d.g,Object(c.a)(Object(c.a)(Object(c.a)({background:t.background},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,children:Object(w.jsxs)("div",{className:"funnelStepStudent__first--info",children:[Object(w.jsx)("div",{children:Object(w.jsx)(z.c,{to:"/student/".concat(e._id),children:L("".concat(e.surname," ").concat(e.name," ").concat(e.midname).length,e,"",25,"230px","\u0424\u0418\u041e:")})}),Object(w.jsxs)("div",{children:[Object(w.jsx)(d.m,{children:"\u0422\u0435\u043b.\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044f:"})," ","78"]}),Object(w.jsxs)("div",{children:[Object(w.jsx)(d.m,{children:"\u041c\u0438\u043d.\u0410\u0431\u043e\u043d\u0435\u043c\u0435\u043d\u0442:"})," ",e.minPaidSubscription||0,"\u20bd"]}),Object(w.jsx)(d.j,{portable:!0,contains:e.statuses.length,children:e.statuses.map((function(e){return Object(w.jsx)(M.a,{color:e.color,children:e.name},e._id)}))}),e.closestTask.length?Object(w.jsx)(U.a,{overlay:Object(w.jsx)(V,{closestTask:e.closestTask[0]}),children:Object(w.jsx)(d.i,{children:"\u0411\u043b\u0438\u0436\u0430\u0439\u0448\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430"})}):""]})}))}},e._id)}))})};t.default=function(){var e=q.a,t=Object(o.useState)(!0),n=Object(l.a)(t,2),a=n[0],j=n[1],b=Object(o.useState)([]),O=Object(l.a)(b,2),p=O[0],h=O[1],x=Object(o.useState)([]),f=Object(l.a)(x,2),v=f[0],m=f[1];Object(o.useEffect)((function(){try{(function(){var t=Object(s.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(k.b)(e);case 2:n=t.sent,h((function(){return n})),m((function(){return n.map((function(e){return e.pupils})).flat(2)})),j((function(){return!1}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}catch(t){Object(S.e)("\u041e\u0448\u0438\u0431\u043a\u0430!","\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043a\u0430\u043a\u0430\u044f-\u0442\u043e \u043e\u0448\u0438\u0431\u043a\u0430")}return function(){h((function(){return[]})),m((function(){return[]}))}}),[e]);var g=function(){var t=Object(s.a)(i.a.mark((function t(n){var c,a,s,o,j,u,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.destination){t.next=2;break}return t.abrupt("return",m((function(e){return e})));case 2:if(c=v.filter((function(e){return e.salesFunnelStep===n.source.droppableId})),a=v.filter((function(e){return e.salesFunnelStep===n.destination.droppableId})),s=c.splice(n.source.index,1),o=Object(l.a)(s,1),j=o[0],u=m((function(e){return Object(r.a)(new Set([].concat(Object(r.a)(e),Object(r.a)(c),Object(r.a)(a))))})),n.source.droppableId!==n.destination.droppableId){t.next=9;break}return c.splice(n.destination.index,0,j),t.abrupt("return",u);case 9:return d=j.statuses,j.statuses=j.statuses.map((function(e){return e._id})),j.salesFunnelStep=n.destination.droppableId,t.next=14,Object(k.c)(e,j._id,j);case 14:return j.statuses=d,a.splice(n.destination.index,0,j),t.abrupt("return",u);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(w.jsx)(d.n,{children:a?Object(w.jsx)(T,{}):Object(w.jsx)(d.c,{jstctn:p.length<6,children:Object(w.jsx)(u.a,{onDragEnd:g,children:p.map((function(t){return Object(w.jsxs)(d.d,{style:"\u0417\u0430\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f"===t.name||"\u0417\u0430\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f"===t.name?{display:"none"}:{display:"block"},className:"card",children:[Object(w.jsxs)(d.f,{background:t.background,children:[D(t.name.length,t.name,"",30,"220px"),1===t.order?Object(w.jsx)(I,{setLoaded:j,status:1,funnel:p,Url:e,setPupilsList:m}):""]}),Object(w.jsxs)(d.e,{background:t.background,children:[t.minPaidSubscriptionsAmount||0,"\u0440\u0443\u0431."]}),Object(w.jsx)(u.c,{droppableId:"".concat(t._id),children:function(n){return Object(w.jsxs)("div",Object(c.a)(Object(c.a)({className:"droppable-container",ref:n.innerRef},n.droppableProps),{},{children:[Object(w.jsx)(H,{card:t,pupils:{pupilsList:v,setPupilsList:m},Url:e}),n.placeholder]}))}})]},t._id)}))})})})}}}]);
//# sourceMappingURL=4.34b66683.chunk.js.map